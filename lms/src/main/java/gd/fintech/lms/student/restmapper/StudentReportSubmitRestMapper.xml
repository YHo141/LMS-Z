<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gd.fintech.lms.student.restmapper.StudentReportSubmitRestMapper">
	<!-- 학생 과제 제출 빈도 -->
	<select id="selectReportSubmit" parameterType="java.lang.String" resultType="java.util.Map">
		SELECT
			(SELECT COUNT(*) FROM report WHERE lecture_no=4) 'fintechAll',
			nvl(SUM(case when r.lecture_no = 4 AND rs.account_id=#{studentId} then 1 END), 0) 'fintech',
			(SELECT COUNT(*) FROM report WHERE lecture_no=5) 'JAVAccAll',
			nvl(SUM(case when r.lecture_no = 5 AND rs.account_id=#{studentId} then 1 END), 0) 'JAVAcc',
			(SELECT COUNT(*) FROM report WHERE lecture_no=10) 'DoraemonAll',
			nvl(SUM(case when r.lecture_no = 10 AND rs.account_id=#{studentId} then 1 END), 0) 'Doraemon',
			(SELECT COUNT(*) FROM report WHERE lecture_no=11) 'DigitalEngineeringAll',
			nvl(SUM(case when r.lecture_no = 11 AND rs.account_id=#{studentId} then 1 END), 0) 'DigitalEngineering',
			(SELECT COUNT(*) FROM report WHERE lecture_no=12) 'CshopAll',
			nvl(SUM(case when r.lecture_no = 12 AND rs.account_id=#{studentId} then 1 END), 0) 'Cshop'
		FROM report r
		LEFT JOIN report_submit rs
		ON r.report_no = rs.report_no
	</select>
</mapper>